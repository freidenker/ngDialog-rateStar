<link rel="stylesheet" href="bootstrap.min.css">
<link rel="stylesheet" href="bower_components/ng-dialog/css/ngDialog.css">
<link rel="stylesheet" href="bower_components/ng-dialog/css/ngDialog-theme-default.css">
<link rel="stylesheet" href="bower_components/ng-dialog/css/ngDialog-theme-plain.css">
 <link rel="stylesheet" type="text/css" href="bower_components/font-awesome/css/font-awesome.css">
<body ng-app="exampleDialog" ng-controller="MainCtrl">
<div >
<button type="button" ng-dialog="firstDialogId" ng-dialog-controller="InsideCtrl" ng-dialog-data="{{jsonData}}" ng-dialog-class="ngdialog-theme-default" ng-dialog-show-close="true">Open via directive</button>
<a href ng-click="openTemplate()">open template</a>
<a href ng-click="openPlain()">open plain</a>
<a href ng-click="openDefault()">open default</a>
<div>
<p>{{feed.back}}</p>
<p>{{feed.content}}</p>
</div>
<script src="angular.min.js"></script>
<script src="bower_components/ng-dialog/js/ngDialog.js"></script>


<script type="text/ng-template" id="firstDialogId">
<div class="ngdialog-message">
<h3>ngDialog template</h3>
<p ng-show="theme">Test content for <code>{{theme}}</code></p>
<p ng-show="ngDialogData.foo">Data passed through directive: <code>{{ngDialogData.foo}}</code></p>
</div>
<div class="ngdialog-buttons">
<button type="button" class="ngdialog-button ngdialog-button-primary" ng-click="openSecond()">Open next</button>
</div>
</script>



<script>
var app = angular.module('exampleDialog', ['ngDialog']);
app.controller('MainCtrl', function ($scope, $rootScope, ngDialog) {
$rootScope.jsonData = '{"foo": "bar"}';
$rootScope.theme = 'ngdialog-theme-default';
$scope.open = function () {
ngDialog.open({ template: 'firstDialogId', controller: 'InsideCtrl' });
};


$scope.openDefault = function () {
ngDialog.open({
template: 'firstDialogId',
controller: 'InsideCtrl',
className: 'ngdialog-theme-default'
});
};

$scope.openPlain = function () {
$rootScope.theme = 'ngdialog-theme-plain';
ngDialog.open({
template: 'firstDialogId',
controller: 'InsideCtrl',
className: 'ngdialog-theme-plain'
});
};

$scope.openTemplate = function () {
$scope.value = true;
ngDialog.open({
template: 'externalTemplate.html',
controller: 'InsideCtrl',
className: 'ngdialog-theme-default',
scope: $scope
});
}

});


app.controller('InsideCtrl', function ($scope, ngDialog) {
$scope.openSecond = function () {
ngDialog.open({
/*template: '<h3>' +
          '<a href="" ng-click="closeSecond()">Close all by click here!</a>'+
          '</h3>',
*/
template:  '<h3 style="text-align:center">Rating</h3>'
           + '<div ng-init="rating = star.rating + 1" style="text-align:center"></div>'
           + '<div class="star-rating" star-rating rating-value="rating" data-max="5" on-rating-selected="rateFunction(rating)" style="text-align:center"> </div><br>'
           + '<form style="text-align:center"><textarea rows="5" cols="20" class="form-control" ng-model=feed.content placeholder="tell us your advise"></textarea><br><br><button class="btn" ng-click="closeSecond()">Commit &nbsp; <button class="btn" ng-click="closeSecond()">Concel</form>',

//template: "<button type='button' ng-dialog='npdpop.html' ng-dialog-class='ngdialog-theme-flat' ng-dialog-controller='SecondModalCtrl' ng-dialog-close-previous>Open</button>",
//template: 'npdpop.html',
plain: true,
closeByEscape: false,
//controller: 'SecondModalCtrl'
controller: 'RatingCtrl'
});
};
});

app.controller('SecondModalCtrl', function ($scope, ngDialog) {
$scope.closeSecond = function () {
ngDialog.close();
};
});

app.controller('RatingCtrl', function ($scope, $rootScope, ngDialog) {
  $scope.rating = 5;
  $rootScope.feed={back: 0, content: ""};
  $scope.rateFunction = function(rating) {
    alert('Rating selected new- ' + rating);
    $rootScope.feed.back=rating;
  };
  $scope.closeSecond = function () {
  ngDialog.close();
  };
});

app.directive('starRating',
function() {
 return {
   restrict : 'A',
   template : '<ul class="rating">'
        + '	<li ng-repeat="star in stars" ng-class="star" ng-click="toggle($index)" class="fa fa-star active">'

        + '</li>'
        + '</ul>',
   scope : {
     ratingValue : '=',
     max : '=',
     onRatingSelected : '&'
   },
   link : function(scope, elem, attrs) {
     var updateStars = function() {
       scope.stars = [];
       for ( var i = 0; i < scope.max; i++) {
         scope.stars.push({
           filled : i < scope.ratingValue
         });
       }
     };

     scope.toggle = function(index) {
       scope.ratingValue = index + 1;
       scope.onRatingSelected({
         rating : index + 1
       });
     };

     scope.$watch('ratingValue',
       function(oldVal, newVal) {
         if (newVal) {
           updateStars();
         }
       }
     );
   }
 };
});


</script>
<style>
.rating{
  color: #D1D1D1;
  margin: 0;
  padding: 0;
}

ul.rating {
  display: inline-block;
}

.rating li {
  list-style-type: none;
  display: inline-block;
  padding: 4px;
  font-size: 25px;
  text-align: center;
  font-weight: bold;
  cursor: pointer;
}

.rating .filled {
 color: #FDE35E;
}
</style>

</div>
</body>
